title: PowerShell Exploit Scripts
description: Detects the creation of known powershell scripts for exploitation
author: Furkan Celik
status: stable
date: 2020/07/02
tags:
- attack.execution
- attack.T1086
logsource:
  product: windows
  service: sysmon
detection:
  condition: selection
  selection:
    TargetFilename:
    - '*\Invoke-DllInjection.ps1'
    - '*\Invoke-WmiCommand.ps1'
    - '*\Get-GPPPassword.ps1'
    - '*\Get-Keystrokes.ps1'
    - '*\Get-VaultCredential.ps1'
    - '*\Invoke-CredentialInjection.ps1'
    - '*\Invoke-NinjaCopy.ps1'
    - '*\Invoke-Mimikatz.ps1'
    - '*\Get-TimedScreenshot.ps1'
    - '*\Get-ServiceFilePermission.ps1'
    - '*\Get-VulnSchTask.ps1'
    - '*\Add-RegBackdoor.ps1'
    - '*\Check-VM.ps1'
    - '*\Invoke-PowerShellWMI.ps1'
    - '*\Get-ClipboardContents.ps1'
    - '*\Invoke-PostExfil.ps1'
    - '*\Exploit-Jboss.ps1'
    - '*\Get-SecurityPackages.ps1'
    - '*\Invoke-Tater.ps1'
    - '*\Invoke-Paranoia.ps1'
    - '*\Invoke-TokenManipulation.ps1'
    - '*\Out-Minidump.ps1'
    - '*\Invoke-UserHunter.ps1'
    - '*\Get-ServicePermission.ps1'
    - '*\Invoke-RunAs.ps1'
    - '*\PowerBreach.ps1'
    - '*\PowerView.ps1'
    - '*\PowerUp.ps1'
    - '*\Invoke-PortScan.ps1'
    - '*\Invoke-ARPScan.ps1'
    - '*\Invoke-WScriptBypassUAC.ps1'
    - '*\Invoke-WinEnum.ps1'
    - '*\Install-SSP.ps1'
    - '*\Invoke-ThunderStruck.ps1'
    - '*\Invoke-PSInject.ps1'
    - '*\Get-FoxDump.ps1'
    - '*\Add-Exfiltration.ps1'
    - '*\Add-ScrnSaveBackdoor.ps1'
    - '*\Get-UnattendedInstallFile.ps1'
    - '*\Find-GPOLocation.ps1'
    - '*\VolumeShadowCopyTools.ps1'
    - '*\Invoke-BackdoorLNK.ps1'
    - '*\Invoke-ReflectivePEInjection.ps1'
    - '*\Invoke-ReverseDNSLookup.ps1'
    - '*\Invoke-SMBScanner.ps1'
    - '*\Invoke-Mimikittenz.ps1 '
    - '*\Get-RickAstley.ps1'
    - '*\Find-Fruit.ps1'
    - '*\Invoke-VoiceTroll.ps1'
    - '*\HTTP-Login.ps1'
    - '*\Set-Wallpaper.ps1'
    - '*\Get-IndexedItem.ps1'
    - '*\Find-TrustedDocuments.ps1'
    - '*\Get-SiteListPassword.ps1'
    - '*\Invoke-BypassUAC.ps1'
    - '*\New-HoneyHash.ps1'
    - '*\Show-TargetScreen.ps1'
    - '*\Get-RegAlwaysInstallElevated.ps1'
    - '*\Get-ChromeDump.ps1'
    EventID:
    - 11
fields:
- TargetFilename
- User
- Image
falsepositives:
- ""
level: high