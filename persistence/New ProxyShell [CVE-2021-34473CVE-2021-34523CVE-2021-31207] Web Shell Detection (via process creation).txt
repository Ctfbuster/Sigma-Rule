title: New ProxyShell [CVE-2021-34473/CVE-2021-34523/CVE-2021-31207] Web Shell Detection (via process creation)
description: This rule is used to detect the webshell step of the vulnerability called proxyshell. The login.aspx web shell is a simple web shell which takes a command and runs it using cmd.exe. It appears that the threat actor is using aspx_qdajscizfzc.aspx to load login.aspx and therefore the main process is w3wp.
author: Furkan Celik
status: stable
tags:
- attack.persistence
- attack.t1505.003
date: 2022/01/13
references:
- https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/
logsource:
  product: windows
  service: process_creation
detection:
  condition: selection and selection1
  selection:
    ParentImage|contains:
    - MSExchangeMailboxReplication.exe
    Image|contains:
    - aspx_qdajscizfzc.aspx
  selection1:
    ParentImage|contains:
    - w3wp.exe
    Image|contains:
    - login.aspx
fields:
- Image
- ParentImage
falsepositives:
- none
level: high